{% extends "base.html" %}

{% block content %}
    <div class="title-area">
        <div class="content-area content-area_block">
            <div class="breadcrumbs">
                <a class="breadcrumbs__item breadcrumbs_first" href="#">
                Главная
                </a>
                <span class="breadcrumbs__delimeter">
                /
                </span>
            </div>
            <h1 class="title title_catalog">
            {{category.name}}
            </h1>
            <div class="title-area__buttons">
                <div class="row">
                    <div class="col col-6">
                        <div class="button button_grey mobile-catalog-button drawer-btn"
                            href="#drawer-filters"
                        >
                            <span class="button__text">
                                Фильтры
                            </span>
                            <span class="button_count round-count">
                                11
                            </span>
                        </div>
                    </div>
                    <div class="col col-6">
                        <div class="button button_grey mobile-catalog-button drawer-btn"
                            href="#drawer-sorting"
                        >
                            По популярности
                        </div>
                    </div>
                </div>
            </div>
            <div class="title-area__tags tags row">
                <div class="tag">
                    От 5500 ₽
                </div>
                <div class="tag">
                    До 98 300 ₽
                </div>
                <div class="tag">
                    США
                </div>
                <div class="tag">
                    Красный
                </div>
            </div>
            <div class="title-area__sorting row">
                <div class="title-area__count-wrap col col-12 d-col-3 w-col-2">
                    <div class="title-area__count">
                        <div class="title-area__count-text">
                        {{page_obj.paginator.count}} товаров
                        </div>
                    </div>
                </div>
                <div class="sorting-bar" id="sorting-bar">
                    <div class="sorting-bar__controls">
                        <div class="sorting-bar__label">
                        Сортировать:
                        </div>
                        <div class="sorting-item inc-dec {{sorting_option_class('price', sorting_option)}}"
                            data-option="price"
                        >
                            <span>по цене</span>
                            <i class="icon sorting-icon">
                            </i>
                        </div>
                        <div class="sorting-item {{sorting_option_class('scoring', sorting_option)}}"
                            data-option="scoring"
                        >
                            <span>по популярности</span>
                            <i class="icon sorting-icon">
                            </i>
                        </div>
                        <div class="sorting-item {{sorting_option_class('created_at', sorting_option)}}"
                            data-option="created_at"
                        >
                            <span>по новинкам</span>
                            <i class="icon sorting-icon">
                            </i>
                        </div>
                        <div class="sorting-item {{sorting_option_class('sale_percentage', sorting_option)}}"
                            data-option="sale_percentage"
                        >
                            <span>по скидкам</span>
                            <i class="icon sorting-icon">
                            </i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="content-area content-area_block">
        <div class="catalog row">
            <div class="catalog__left col col-1 d-col-3 w-col-2">

                <div class="filter"
                    data-id="{{filters[0].id}}"
                    data-key={{filters[0].key}}
                >
                    <div class="filter-heading">
                        <span class="filter-title">
                        {{filters[0].name}}
                        </span>
                        <i class="icon icon_chevron-down">
                        </i>
                    </div>
                    <div class="filter-panel">
                        <ul class="filter-values-list scrollable">
                        {% for value in filters[0].values %}
                        <div class="filter-value" data-id="{{value.id}}">
                            <span>{{ value.value }}</span>
                            <span class="filter-count">
                            </span>
                        </div>
                        {% endfor %}
                        </ul>
                    </div>
                </div>

                {% for item in filters[1:] %}
                <div class="filter"
                    data-id="{{item.id}}"
                    data-key="{{item.key}}"
                >
                    <div class="filter-heading">
                        <span class="filter-title">
                        {{item.name}}
                        </span>
                        <i class="icon icon_chevron-down">
                        </i>
                    </div>
                    <div class="filter-panel">
                        <ul class="filter-values-list scrollable">
                        {% for value in item.values %}
                        <div class="filter-value">
                            <span>{{ value.value }}</span>
                        </div>
                        {% endfor %}
                        </ul>
                    </div>
                </div>
                {% endfor %}
            </div>
            <div class="catalog__right col col-12 d-col-9 w-col-10">
                <div class="catalog__tags tags row">
                    {% for tag in tags %}
                    <div class="tag">
                        {{tag.value}}
                        <div class="tag__close">
                            <i class="icon icon_close tag__icon">
                            </i>
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="catalog__gallery row">
                    {% for product in products %}
                        <div class="product-card">
                            <a href="/watches/{{ product.slug }}/">
                                <div class="product-card__img-wrap">
                                    <img class="product-card__img" src="{{ product.thumbnail.url }}">
                                </div>
                            </a>
                            <div class="product-card__data">
                                <div class="product-card__info">
                                    <a href="/watches/{{ product.slug }}/">
                                        <div class="product-card__brand">
                                            {{product.brand}}
                                        </div>
                                        <div class="product-card__series">
                                            {{product.series}}
                                        </div>
                                        <div class="product-card__model">
                                            {{ product.model }}
                                        </div>
                                    </a>
                                </div>
                                <div class="product-card__price">
                                    {{product.price}} ₽
                                </div>
                                <div class="product-card__extra">
                                    <div class="mini-button mini-button_like">
                                        <i class="icon icon_heart">
                                        </i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    {% endfor %}
                </div>

                <div class="pagination catalog__pagination">
                    <div class="pagination__load-mobile button button_big button_filled show-mb">
                        ПОКАЗАТЬ ЕЩЁ
                    </div>
                    <div class="pagination__pages-wrap">
                        <div class="pagination__pages row">
                            {% for page in page_obj.page_range %}
                                {% if not page %}
                                <div class="page-btn page-btn_disabled hide-mb">
                                    ...
                                </div>
                                {% else %}
                                    {% if page == page_obj.number %}
                                    <a class="page-btn page-btn_active">
                                        {{page}}
                                    </a>
                                    {% else %}
                                    <a class="page-btn"
                                        href="{{request.path}}{{ update_pagination(querystring=request.GET, kwargs={'page':page}) }}"
                                    >
                                        {{page}}
                                    </a>
                                    {% endif %}
                                {% endif %}
                            {% endfor %}
                        </div>
                        {% if page_obj.has_next() %}
                        <a class="page-btn page-btn_next hide-mb"
                            href="{{request.path}}{{ update_pagination(querystring=request.GET, kwargs={'page':page_obj.next_page_number()}) }}"
                        >
                            СЛЕДУЮЩАЯ
                        </a>
                        {% else %}
                        <div class="pagination-load_disabled page-btn_next hide-mb">
                            СЛЕДУЮЩАЯ
                        </div>
                        {% endif %}
                        <div class="clearfix">
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

{% endblock content %}

{% block modals %}
    {{ super() }}
    <div class="drawer drawer-left drawer-filters" id="drawer-filters">
        <div class="drawer-content drawer-content_left">
            <div class="drawer-filters-header">
                <div class="drawer-filters-title heading-2">
                    Фильтры
                </div>
                <div class="drawer-filters-clear">
                    Очистить
                </div>
            </div>
            <div class="drawer-filters-body">
                <ul class="drawer-filters-list">
                    {% for item in filters %}
                    <div class="filter">
                        <div class="filter-heading">
                            <div class="filter-title">
                                {{item.name}}
                            </div>
                        </div>
                        <div class="filter-panel">
                        </div>
                    </div>
                    {% endfor %}
                </ul>
            </div>
            <div class="drawer-filters-footer">
                <div class="button button_accent">
                    Показать 777 товаров
                </div>
            </div>
        </div>
        <div class="drawer-overlay">
        </div>
    </div>
    <div class="drawer drawer-bottom drawer-sorting" id="drawer-sorting">
        <div class="drawer-content drawer-content_bottom">
            <div class="mobile-sorting">
                <div class="mobile-sorting-title bold">
                Сортировать...
                </div>
                <ul class="sorting-list">
                    <li class="sorting-list-item">
                        <span>
                        по цене
                        </span>
                    </li>
                    <li class="sorting-list-item">
                        <span>
                        по цене
                        </span>
                    </li>
                    <li class="sorting-list-item">
                        <span>
                        поп популярности
                        </span>
                    </li>
                    <li class="sorting-list-item">
                        <span>
                        по новинкам
                        </span>
                    </li>
                    <li class="sorting-list-item">
                        <span>
                        по скидкам
                        </span>
                    </li>
                </ul>
            </div>
        </div>
        <div class="drawer-overlay">
        </div>
    </div>
{% endblock modals %}

{% block javascript %}
    {{ super() }}
    <script type="text/javascript">
        var categoryId = {{category.id}};
        var NODE_VALUES = '{{node_values}}'
    </script>
    <script src="{{ static('js/catalogPage.js') }}"></script>
{% endblock javascript %}